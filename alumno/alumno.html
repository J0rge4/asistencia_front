<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel del Alumno</title>
  <link rel="stylesheet" href="../style.css"> <!-- Estilo compartido -->
  <!-- Importa FontAwesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
  <header>Panel del Alumno</header>

  <div style="margin: 1rem;">
    <button onclick="window.location.href='../index.html'" style="background-color:#c62828; color:white; padding:10px;">⏻ Salir</button>
  </div>

  <div class="container">
    <h2>Consultar Asistencia</h2>

    <input type="text" id="matricula" placeholder="Tu matrícula">
    <input type="date" id="fechaConsulta" placeholder="Selecciona la fecha">
    <button onclick="consultar()"><i class="fas fa-search"></i><span>Consultar</span></button>

    <h3>Resultados</h3>
    <ul id="resultado"></ul>
  </div>

  <script>
    const api = 'https://asistenciabackend-production-f2de.up.railway.app'; 

    async function consultar() {
      const mat = document.getElementById('matricula').value.trim(); 
      const fecha = document.getElementById('fechaConsulta').value;  

      if (!mat) return alert('Escribe tu matrícula');
      if (!fecha) return alert('Selecciona una fecha');

      try {
        const res = await fetch(`${api}/api/alumnos/asistencia/${mat}?fecha=${fecha}`);
        if (!res.ok) throw new Error('No se pudo obtener los datos');
        const data = await res.json();

        const ul = document.getElementById('resultado');
        ul.innerHTML = '';

        if (data.length === 0) {
          ul.innerHTML = '<li>No hay registros de asistencia.</li>';
          return;
        }

        data.forEach(r => {
          const li = document.createElement('li'); 
          li.textContent = `${r.fecha}: ${r.presente ? '✅ Presente' : '❌ Ausente'}`;
          ul.appendChild(li);
        });

      } catch (err) {
        alert('Error al consultar asistencia: ' + err.message);
      }
    }
  </script>
</body>
</html>


